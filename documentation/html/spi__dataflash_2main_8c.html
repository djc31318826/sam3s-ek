<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SAM3S Software Package: S:/projets/EK/SAM3S-EK/sam3s_project_trunk/examples/spi_dataflash/main.c File Reference</title>
<link href="common/style.css" rel="stylesheet" type="text/css"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
    <div id="body">
        <div id="title">SAM3S Software Package 2.1</div>
        <div id="banner"></div>

<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="dir_8daa2f36720c02bc89595e4a26f848fc.html">examples</a>      </li>
      <li><a class="el" href="dir_d1f78b3349f9e9e6cca14c952e117e63.html">spi_dataflash</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>main.c File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &quot;<a class="el" href="board_8h_source.html">board.h</a>&quot;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdarg.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>

<p><a href="spi__dataflash_2main_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spi__dataflash_2main_8c.html#ab0b85f88106c448804e16bb055c600cd">SPCK</a>&nbsp;&nbsp;&nbsp;1000000</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a840291bc02cba5474a4cb46a9b9566fe"></a><!-- doxytag: member="spi_dataflash/main.c::main" ref="a840291bc02cba5474a4cb46a9b9566fe" args="(void)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spi__dataflash_2main_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tests the <a class="el" href="struct_at45.html" title="Dataflash driver structure.">At45</a> connected to the board by performing several command on each of its pages. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>spi_dataflash SPI Dataflash Example</p>
<h2><a class="anchor" id="Purpose"></a>
Purpose</h2>
<p>The spi_dataflash example will help new users get familiar with SPI interface on sam3s. This example gives you an AT45 Dataflash programming code so that can help develop your own SPI devices applications with maximum efficiency.</p>
<p>You can find following information depends on your needs:</p>
<ul>
<li>A <a class="el" href="struct_spi.html" title="Spi hardware registers.">Spi</a> low level driver performs SPI device Initializes, data transfer and receive. It can be used by upper SPI driver such as AT45 dataflash.</li>
<li>A Dataflash driver is based on top of the corresponding <a class="el" href="struct_spi.html" title="Spi hardware registers.">Spi</a> driver. It allow user to do operations with dataflash in a unified way.</li>
</ul>
<h2><a class="anchor" id="Requirements"></a>
Requirements</h2>
<p>This package can be used with sam3s-ek and external Data Flash connected. Please connect the SPI peripheral to external board like following matching pairs:</p>
<ul>
<li><b>SAM3S--DataFlash</b></li>
<li>VCC--VCC</li>
<li>GND--GND</li>
<li>NPCS0--NSS</li>
<li>MISO--MISO</li>
<li>MOSI--MOSI</li>
<li>SPCK--SPCK</li>
</ul>
<h2><a class="anchor" id="Description"></a>
Description</h2>
<p>The demonstration program tests the dataflash connected to the evaluation kit by erasing and writing each one of its pages.</p>
<h2><a class="anchor" id="Requirements"></a>
Requirements</h2>
<ol type="1">
<li>Build the program and download it inside the evaluation board. Please refer to the <a href="http://www.atmel.com/dyn/resources/prod_documents/doc6224.pdf">SAM-BA User Guide</a>, the <a href="http://www.atmel.com/dyn/resources/prod_documents/doc6310.pdf">GNU-Based Software Development</a> application note or to the <a href="ftp://ftp.iar.se/WWWfiles/arm/Guides/EWARM_UserGuide.ENU.pdf">IAR EWARM User Guide</a>, depending on your chosen solution.</li>
<li>On the computer, open and configure a terminal application (e.g. HyperTerminal on Microsoft Windows) with these settings:<ul>
<li>115200 bauds</li>
<li>8 bits of data</li>
<li>No parity</li>
<li>1 stop bit</li>
<li>No flow control</li>
</ul>
</li>
<li>Start the application.</li>
<li>Upon startup, the application will output the following lines on the terminal. <div class="fragment"><pre class="fragment">    -- <a class="code" href="group___s_a_m3_s__base.html#gaadd93900fc87105fa3ef514675d4133b" title="(SPI ) Base Address">SPI</a> Dataflash Example xxx --
    -- xxxxxx-xx
    -- Compiled: xxx xx xxxx xx:xx:xx --
    -I- Initializing the <a class="code" href="group___s_a_m3_s__base.html#gaadd93900fc87105fa3ef514675d4133b" title="(SPI ) Base Address">SPI</a> and AT45 drivers
    -I- <a class="code" href="struct_at45.html" title="Dataflash driver structure.">At45</a> enabled
    -I- Waiting <span class="keywordflow">for</span> a dataflash to be connected ...
</pre></div></li>
<li>As soon as a dataflash is connected, the tests will start. Eventually, the test result (pass or fail) will be output to the hyperterminal. </li>
</ol>
<h2><a class="anchor" id="References"></a>
References</h2>
<ul>
<li><a class="el" href="spi__dataflash_2main_8c.html">spi_dataflash/main.c</a></li>
<li><a class="el" href="spi__pdc_8c.html">spi_pdc.c</a></li>
<li>spi_at45.c</li>
<li>at45d.c</li>
</ul>
<p>This file contains all the specific code for the spi_dataflash example. </p>

<p>Definition in file <a class="el" href="spi__dataflash_2main_8c_source.html">main.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ab0b85f88106c448804e16bb055c600cd"></a><!-- doxytag: member="main.c::SPCK" ref="ab0b85f88106c448804e16bb055c600cd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SPCK&nbsp;&nbsp;&nbsp;1000000</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>SPI clock frequency, in Hz. </p>

<p>Definition at line <a class="el" href="spi__dataflash_2main_8c_source.html#l00117">117</a> of file <a class="el" href="spi__dataflash_2main_8c_source.html">main.c</a>.</p>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
